## Construct Kinetic Hamiltonian (lattice version)  
**Prompt:**  
You will be instructed to describe the kinetic term of Hamiltonian in BiNiO$_3$ in the real space in the second-quantized form.   
The degrees of freedom of the system are: orbital index ($a$ for electron at Ni sites, $b$ for electron at Bi sites) and spin index (spin up and spin down)     
The kinetic term is a tight-binding model composed of the following hopping process: 
Ni-Ni bonds with the amplitude $t_{\rm N}$, Bi-Bi bonds with the amplitude $t_{\rm B}$, and Bi-Ni bonds with the amplitude $t_{\rm BN}$, and Bi-Ni bonds with the amplitude $t_{\rm BN}$, onsite chemical potential of $n^{\rm N}_{i \sigma}$ with the amplitude $\Delta$.
You should ensure the hermiticity of the Hamiltonian
The summation should be taken over all orbital index ($a$ for electron at Ni sites, $b$ for electron at Bi sites) and spin index (spin up and spin down) and all real space positions.  
Return the Kinetic Hamiltonian $T$.

Use the following conventions for the symbols:  
$a_{i \sigma}$ and $b_{i \sigma}$ represent the annihilation operators of electron with the spin $\sigma(=\uparrow, \downarrow)$ at the Ni and Bi sites of $i$-th unit cell, respectively; 
$n^{\rm N}_{i \sigma} = a^{\dagger}_{i \sigma} a_{i \sigma}$ and $n^{\rm B}_{i \sigma} = b^{\dagger}_{i \sigma} b_{i \sigma}$.

**Completion:**  
The kinetic term of the Hamiltonian in the second-quantized form can be written as:

$T = -t_{\rm N} \sum_{\langle i,j \rangle, \sigma} (a^{\dagger}_{i \sigma} a_{j \sigma} + h.c.) - t_{\rm B} \sum_{\langle i,j \rangle, \sigma} (b^{\dagger}_{i \sigma} b_{j \sigma} + h.c.) - t_{\rm BN} \sum_{i, \sigma} (a^{\dagger}_{i \sigma} b_{i \sigma} + b^{\dagger}_{i \sigma} a_{i \sigma}) + \Delta \sum_{i, \sigma} n^{\rm N}_{i \sigma}$

Here, the first two terms represent the hopping between Ni-Ni and Bi-Bi sites, respectively. The third term represents the hopping between Bi-Ni sites. The last term represents the onsite chemical potential of Ni sites. The symbol $\langle i,j \rangle$ denotes nearest-neighbor pairs of sites, and $\sigma$ denotes the spin index. The symbol $h.c.$ denotes the Hermitian conjugate of the preceding term, ensuring the hermiticity of the Hamiltonian.

## Construct interaction Hamiltonian (real space, lattice version)  
**Prompt:**  
You will be instructed to construct the interaction part of the Hamiltonian, $H_{int}$ in the real space in the second-quantized form.   
The interacting Hamiltonian has the same degrees of freedom as the kinetic Hamiltonian $T$.  
The interaction is a density-density interaction composed of the following process:
Bi-Bi and Bi-Ni sites with the interaction strength $V_{\rm B}$ and $V_{\rm BN}$ respectively. Onsite Coulomb interaction on Bi with the interaction strength $U_{\rm B}$, and onsite Coulomb interaction on Ni with the interaction strength $U_{\rm N}$.
The summation should be taken over all spins and all real space positions.  
Return the interaction term $H_{int}$ in terms of $n^{\rm N}_{i \sigma}$ and $n^{\rm B}_{i \sigma}$.

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encounter undefined symbols. If you find it is never defined or has conflicts in the conventions, you should stop and let me know): 
$a_{i \sigma}$ and $b_{i \sigma}$ represent the annihilation operators of electron with the spin $\sigma(=\uparrow, \downarrow)$ at the Ni and Bi sites of $i$-th unit cell, respectively; 
$n^{\rm N}_{i \sigma} = a^{\dagger}_{i \sigma} a_{i \sigma}$ and $n^{\rm B}_{i \sigma} = b^{\dagger}_{i \sigma} b_{i \sigma}$

**Completion:**  
The interaction part of the Hamiltonian, $H_{int}$, in the real space in the second-quantized form can be constructed as follows:

$H_{int} = U_{\rm B} \sum_{i, \sigma} n^{\rm B}_{i \sigma} n^{\rm B}_{i \bar{\sigma}} + U_{\rm N} \sum_{i, \sigma} n^{\rm N}_{i \sigma} n^{\rm N}_{i \bar{\sigma}} + V_{\rm B} \sum_{\langle i,j \rangle, \sigma, \sigma'} n^{\rm B}_{i \sigma} n^{\rm B}_{j \sigma'} + V_{\rm BN} \sum_{i, \sigma, \sigma'} n^{\rm B}_{i \sigma} n^{\rm N}_{i \sigma'}$

Here, $U_{\rm B}$ and $U_{\rm N}$ are the onsite Coulomb interactions on Bi and Ni respectively, $V_{\rm B}$ is the interaction strength between Bi-Bi sites, and $V_{\rm BN}$ is the interaction strength between Bi-Ni sites. The symbol $\langle i,j \rangle$ denotes nearest-neighbor pairs of sites, and $\sigma$ and $\sigma'$ denote the spin indices. The bar over the $\sigma$ in the first two terms indicates the opposite spin. The summation is taken over all spins and all real space positions.

## Convert noninteracting Hamiltonian in real space to momentum space (lattice version)  
**Prompt:**  
You will be instructed to convert the noninteracting Hamiltonian $T$ in the second quantized form from the basis in real space to the basis in momentum space. 
To do that, you should apply the Fourier transform to $a^{\dagger}_{i \sigma}$ and $b^{\dagger}_{i \sigma}$ in the real space to the $a^{\dagger}_{k, \sigma}$ and $b^{\dagger}_{k, \sigma}$ in the momentum space, which is defined as $a^{\dagger}_{k, \sigma}= \frac{1}{\sqrt{N}} \sum_i a^{\dagger}_{i \sigma} e^{i k \cdot a_i}$ and $b^{\dagger}_{k, \sigma}= \frac{1}{\sqrt{N}} \sum_i b^{\dagger}_{i \sigma} e^{i k \cdot b_i}$, where $i$ is integrated over all sites in the entire real space. You should follow the EXAMPLE below to apply the Fourier transform. Note that hopping have no position dependence now.
You should recall that $T$ is $T = t_{\rm N} \sum_{\langle i,j \rangle, \sigma} (a^{\dagger}_{i \sigma} a_{j \sigma} + h.c.) + t_{\rm B} \sum_{\langle i,j \rangle, \sigma} (b^{\dagger}_{i \sigma} b_{j \sigma} + h.c.) + t_{\rm BN} \sum_{\langle i,j \rangle, \sigma} (a^{\dagger}_{i \sigma} b_{j \sigma} + b^{\dagger}_{j \sigma} a_{i \sigma}) + \Delta \sum_{i, \sigma} n^{\rm N}_{i \sigma}$
Express the total noninteracting Hamiltonian $T$ in terms of $a^{\dagger}_{k, \sigma}$ and $b^{\dagger}_{k, \sigma}$. Simplify any summation index if possible.

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encounter undefined symbols. If you find it is never defined or has conflicts in the conventions, you should stop and let me know):
$a_{i \sigma}$ and $b_{i \sigma}$ represent the annihilation operators of electron with the spin $\sigma(=\uparrow, \downarrow)$ at the Ni and Bi sites of $i$-th unit cell, respectively; 
$n^{\rm N}_{i \sigma} = a^{\dagger}_{i \sigma} a_{i \sigma}$ and $n^{\rm B}_{i \sigma} = b^{\dagger}_{i \sigma} b_{i \sigma}$.


===
EXAMPLE:  
Write a Kinetic Hamiltonian $\hat{H}$ in the second quantized form in the real space, $\hat{H}=\sum_{i,j} t(R_i-R_j) c^\dagger(R_i) c(R_j)$, where $i,j$ are summed over the entire real space.  
Define the Fourier transform $c^\dagger(k)=\frac{1}{\sqrt{N}} \sum_{i}c^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over the entire real space containing $N$ unit cells, $N$ is the number of unit cells.  
This leads to the inverse Fourier transform $c^\dagger(R_i) = \frac{1}{\sqrt{N}} \sum_k c^\dagger(k) e^{-i k \cdot R_i}$, where $k$ is first Brillouin zone.  
Thus, substitute $c^\dagger(R_i)$ and $c(R_j)$ into $\hat{H}$, we get  
$$\hat{H} = \sum_{i,j} t(R_i-R_j) \frac{1}{\sqrt{N}} \sum_{k_1} c^\dagger(k_1) e^{-i k_1 \cdot R_i} \frac{1}{\sqrt{N}} \sum_{k_2} c(k_2) e^{i k_2 \cdot R_j} =\frac{1}{N} \sum_{i,j}\sum_{k_1,k_2} c^\dagger(k_1)  c(k_2)  e^{-i k_1\cdot R_i} e^{i k_2 \cdot R_j} t(R_i-R_j) $$
Now make a replacement by defining $n= R_i-R_j$  
The Hamiltonian become  
$$\hat{H}=\frac{1}{N} \sum_{i,n} \sum_{k_1,k_2} c^\dagger(k_1)  c(k_2) t(n) e^{-i (k_1-k_2)\cdot R_i} e^{-i k_2 \cdot n}$$
Because $\frac{1}{N}\sum_{i} e^{-i (k_1-k_2)\cdot R_i} = \delta(k_1,k_2)$, where $\delta(k_1,k_2)$ is the Kronecker delta function.  
therefore   
$$\hat{H}=\sum_{k_1,k_2} \sum_{n} t(n) e^{-i k_2 \cdot n} c^\dagger(k_1)  c(k_2) \delta(k_1,k_2)$$
Using the property of Kronecker delta function and sum over $k_2$, we obtain  
$$\hat{H}=\sum_{k_1} \sum_{n} t(n) e^{-i k_1 \cdot n} c^\dagger(k_1)  c(k_1) $$
For simplicity, we replace $k_1$ with $k$, we obtain  
$$\hat{H}=\sum_{k} \sum_{n} t(n) e^{-i k \cdot n} c^\dagger(k)  c(k)$$
If we define energy dispersion $E(k)=\sum_{n} t(n) e^{-i k \cdot n}$, where $n$ is the summation of all hopping pairs, the Hamiltonian in the momentum space is 
$$\hat{H}=\sum_{k} E(k) c^\dagger(k)  c(k)$$

**Completion:**  
Following the example, we first define the Fourier transforms for $a^{\dagger}_{i \sigma}$ and $b^{\dagger}_{i \sigma}$:

$a^{\dagger}_{k, \sigma}= \frac{1}{\sqrt{N}} \sum_i a^{\dagger}_{i \sigma} e^{i k \cdot a_i}$ and $b^{\dagger}_{k, \sigma}= \frac{1}{\sqrt{N}} \sum_i b^{\dagger}_{i \sigma} e^{i k \cdot b_i}$

This leads to the inverse Fourier transforms:

$a^{\dagger}_{i \sigma} = \frac{1}{\sqrt{N}} \sum_k a^{\dagger}_{k, \sigma} e^{-i k \cdot a_i}$ and $b^{\dagger}_{i \sigma} = \frac{1}{\sqrt{N}} \sum_k b^{\dagger}_{k, \sigma} e^{-i k \cdot b_i}$

Substituting these into the noninteracting Hamiltonian $T$, we get:

$T = t_{\rm N} \sum_{\langle i,j \rangle, \sigma} \left(\frac{1}{N} \sum_{k_1} a^{\dagger}_{k_1, \sigma} e^{-i k_1 \cdot a_i} \frac{1}{N} \sum_{k_2} a_{k_2, \sigma} e^{i k_2 \cdot a_j} + h.c.\right) + t_{\rm B} \sum_{\langle i,j \rangle, \sigma} \left(\frac{1}{N} \sum_{k_1} b^{\dagger}_{k_1, \sigma} e^{-i k_1 \cdot b_i} \frac{1}{N} \sum_{k_2} b_{k_2, \sigma} e^{i k_2 \cdot b_j} + h.c.\right) + t_{\rm BN} \sum_{\langle i,j \rangle, \sigma} \left(\frac{1}{N} \sum_{k_1} a^{\dagger}_{k_1, \sigma} e^{-i k_1 \cdot a_i} \frac{1}{N} \sum_{k_2} b_{k_2, \sigma} e^{i k_2 \cdot b_j} + \frac{1}{N} \sum_{k_1} b^{\dagger}_{k_1, \sigma} e^{-i k_1 \cdot b_j} \frac{1}{N} \sum_{k_2} a_{k_2, \sigma} e^{i k_2 \cdot a_i}\right) + \Delta \sum_{i, \sigma} n^{\rm N}_{i \sigma}$

Now, we can simplify the summation indices using the property of the Kronecker delta function, $\frac{1}{N}\sum_{i} e^{-i (k_1-k_2)\cdot R_i} = \delta(k_1,k_2)$, and the definitions $n^{\rm N}_{i \sigma} = a^{\dagger}_{i \sigma} a_{i \sigma}$ and $n^{\rm B}_{i \sigma} = b^{\dagger}_{i \sigma} b_{i \sigma}$.

After simplification, the noninteracting Hamiltonian $T$ in the momentum space is:

$T = t_{\rm N} \sum_{k, \sigma} a^{\dagger}_{k, \sigma} a_{k, \sigma} + t_{\rm B} \sum_{k, \sigma} b^{\dagger}_{k, \sigma} b_{k, \sigma} + t_{\rm BN} \sum_{k, \sigma} \left(a^{\dagger}_{k, \sigma} b_{k, \sigma} + b^{\dagger}_{k, \sigma} a_{k, \sigma}\right) + \Delta \sum_{k, \sigma} a^{\dagger}_{k, \sigma} a_{k, \sigma}$

This is the total noninteracting Hamiltonian $T$ in terms of $a^{\dagger}_{k, \sigma}$ and $b^{\dagger}_{k, \sigma}$.

## Convert interacting Hamiltonian in real space to momentum space (lattice version)  
**Prompt:**  
You will be instructed to convert the interacting Hamiltonian, $H_{int}$, in the second-quantized form the basis in real space to the basis in momentum space.
To do that, you should apply the Fourier transform to $a^{\dagger}_{i \sigma}$ and $b^{\dagger}_{i \sigma}$ in the real space to the $a^{\dagger}_{k, \sigma}$ and $b^{\dagger}_{k, \sigma}$ in the momentum space, which is defined as $a^{\dagger}_{k, \sigma}= \frac{1}{\sqrt{N}} \sum_i a^{\dagger}_{i \sigma} e^{i k \cdot a_i}$ and $b^{\dagger}_{k, \sigma}= \frac{1}{\sqrt{N}} \sum_i b^{\dagger}_{i \sigma} e^{i k \cdot b_i}$, where $i$ is integrated over all sites in the entire real space, and $k$ is defined within the first Brillouin zone. You should follow the EXAMPLE below to apply the Fourier transform. Note that interaction have no position dependence now  
You should recall that $H_{int}$ is $H_{int} = U_{\rm B} \sum_{i} (n^{\rm B}_{i \uparrow} n^{\rm B}_{i \downarrow}) + U_{\rm N} \sum_{i} (n^{\rm N}_{i \uparrow} n^{\rm N}_{i \downarrow}) + V_{\rm B} \sum_{\langle i,j \rangle, \sigma, \sigma'} (n^{\rm B}_{i \sigma} n^{\rm B}_{j \sigma'}) + V_{\rm BN} \sum_{\langle i,j \rangle, \sigma, \sigma'} (n^{\rm B}_{i \sigma} n^{\rm N}_{j \sigma'})$
.
Express $H_{int}$ in terms of $a^{\dagger}_{k, \sigma}$ and $b^{\dagger}_{k, \sigma}$. Simplify any summation index if possible.  

===  
EXAMPLE:  
Write an interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form in the real space, $\hat{H}^{int}=\sum_{s,s'}\sum_{i,j} U(R_i-R_j) c_s^\dagger(R_i) c_{s'}^\dagger(R_j) c_{s'}(R_j) c_s(R_i)$, where $i,j$ are summed over the entire real space.  
Define the Fourier transform $c_s^\dagger(k)=\frac{1}{\sqrt{N}} \sum_{i}c_s^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over the entire real space containing $N$ unit cells, $N$ is the number of unit cells.  
This leads to the inverse Fourier transform $c_s^\dagger(R_i) = \frac{1}{\sqrt{N}} \sum_k c_s^\dagger(k) e^{-i k \cdot R_i}$, where $k$ is summed over the first Brillouin zone.  
Thus, substitute $c^\dagger(R_i)$ and $c(R_j)$ into $\hat{H}^{int}$, we get  
$$\hat{H}^{int} = \sum_{s,s'}\sum_{i,j} U(R_i-R_j) \frac{1}{\sqrt{N}} \sum_{k_1} c_s^\dagger(k_1) e^{-i k_1 \cdot R_i} \frac{1}{\sqrt{N}} \sum_{k_2} c_{s'}^\dagger(k_2) e^{-i k_2 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_3} c_{s'}(k_3) e^{i k_3 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_4} c_s(k_4) e^{i k_4 \cdot R_i}=\sum_{s,s'}\sum_{i,j}\frac{1}{N^2}\sum_{k_1,k_2,k_3,k_4}U(R_i-R_j)c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot R_i} e^{-i(k_2-k_3)\cdot R_j}$$
Now make a replacement by defining $n= R_i-R_j$  
The Hamiltonian become  
$$\hat{H}^{int}=\frac{1}{N^2} \sum_{j,n} \sum_{s,s'} \sum_{k_1,k_2,k_3,k_4} U(n) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot n} e^{-i(k_1-k_4+k_2-k_3)\cdot r_j }$$
Because $\frac{1}{N}\sum_{i} e^{-i (k_1-k_4+k_2-k_3)\cdot R_i} = \sum\delta(k_1-k_4+k_2-k_3,G)$, where $\delta(..,..)$ is the Kronecker delta function, and $G$ is the all reciprocal lattices in the momentum space.  
Therefore,  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4} \sum_{n} U(n) e^{-i (k_1-k_4) \cdot n} c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$
If we define interaction in the momentum space $U(k)=\sum_{n} U(n) e^{-i k \cdot n}$, where $n$ is the summation of all hopping pairs, the interacting Hamiltonian in the momentum space is  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4}  U(k_1-k_4) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$

**Completion:**  
First, we define the Fourier transforms for the creation operators $a^{\dagger}_{i \sigma}$ and $b^{\dagger}_{i \sigma}$ as given in the question. This leads to the inverse Fourier transforms:

$a^{\dagger}_{i \sigma} = \frac{1}{\sqrt{N}} \sum_k a^{\dagger}_{k, \sigma} e^{-i k \cdot a_i}$

$b^{\dagger}_{i \sigma} = \frac{1}{\sqrt{N}} \sum_k b^{\dagger}_{k, \sigma} e^{-i k \cdot b_i}$

We substitute these into the interacting Hamiltonian $H_{int}$:

$H_{int} = U_{\rm B} \sum_{i} \left(\frac{1}{N} \sum_{k_1} b^{\dagger}_{k_1, \uparrow} e^{-i k_1 \cdot b_i} b_{k_1, \uparrow} \right) \left(\frac{1}{N} \sum_{k_2} b^{\dagger}_{k_2, \downarrow} e^{-i k_2 \cdot b_i} b_{k_2, \downarrow} \right) + U_{\rm N} \sum_{i} \left(\frac{1}{N} \sum_{k_1} a^{\dagger}_{k_1, \uparrow} e^{-i k_1 \cdot a_i} a_{k_1, \uparrow} \right) \left(\frac{1}{N} \sum_{k_2} a^{\dagger}_{k_2, \downarrow} e^{-i k_2 \cdot a_i} a_{k_2, \downarrow} \right) + V_{\rm B} \sum_{\langle i,j \rangle, \sigma, \sigma'} \left(\frac{1}{N} \sum_{k_1} b^{\dagger}_{k_1, \sigma} e^{-i k_1 \cdot b_i} b_{k_1, \sigma} \right) \left(\frac{1}{N} \sum_{k_2} b^{\dagger}_{k_2, \sigma'} e^{-i k_2 \cdot b_j} b_{k_2, \sigma'} \right) + V_{\rm BN} \sum_{\langle i,j \rangle, \sigma, \sigma'} \left(\frac{1}{N} \sum_{k_1} b^{\dagger}_{k_1, \sigma} e^{-i k_1 \cdot b_i} b_{k_1, \sigma} \right) \left(\frac{1}{N} \sum_{k_2} a^{\dagger}_{k_2, \sigma'} e^{-i k_2 \cdot a_j} a_{k_2, \sigma'} \right)$

We can simplify the summation indices using the property of the Kronecker delta function, $\delta_{k_1,k_2} = \frac{1}{N} \sum_i e^{i (k_1 - k_2) \cdot a_i}$, to obtain the interacting Hamiltonian $H_{int}$ in the momentum space:

$H_{int} = U_{\rm B} \sum_{k_1, k_2} \delta_{k_1,k_2} b^{\dagger}_{k_1, \uparrow} b_{k_1, \uparrow} b^{\dagger}_{k_2, \downarrow} b_{k_2, \downarrow} + U_{\rm N} \sum_{k_1, k_2} \delta_{k_1,k_2} a^{\dagger}_{k_1, \uparrow} a_{k_1, \uparrow} a^{\dagger}_{k_2, \downarrow} a_{k_2, \downarrow} + V_{\rm B} \sum_{k_1, k_2} \delta_{k_1,k_2} b^{\dagger}_{k_1, \sigma} b_{k_1, \sigma} b^{\dagger}_{k_2, \sigma'} b_{k_2, \sigma'} + V_{\rm BN} \sum_{k_1, k_2} \delta_{k_1,k_2} b^{\dagger}_{k_1, \sigma} b_{k_1, \sigma} a^{\dagger}_{k_2, \sigma'} a_{k_2, \sigma'}$

## Wick's theorem  
**Prompt:**  
You will be instructed to perform a Hartree-Fock approximation to expand the interaction term, $H_{int}$.  
You should use Wick's theorem to expand the four-fermion term in $H_{int}$ into quadratic terms. You should strictly follow the EXAMPLE below to expand using Wick's theorem, select the correct EXAMPLE by noticing the order of four-term product with and without ${}^\dagger$, and be extremely cautious about the order of the index and sign before each term.  
You should only preserve the normal terms. Here, the normal terms mean the product of a creation operator and an annihilation operator.  
You should recall that $H_{int}$ is $H_{int} = \frac{U_{\rm B}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \sum_G\delta_{k_1+k_3-k_2-k_4,G} + \frac{U_{\rm N}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \sum_G\delta_{k_1+k_3-k_2-k_4,G} + \frac{V_{\rm B} }{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \sum_n e^{-i(k_3-k_4)\cdot n} \sum_G\delta_{k_1+k_3-k_2-k_4,G} + \frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \sum_{n'} e^{-i(k_3-k_4)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$, where $n$ is the lattice vector connecting nearest Ni (or, equivalently, Bi), and $n'$ is the lattice vector connecting nearest Bi and Ni..  
Return the expanded interaction term after Hartree-Fock approximation as $\hat{H}^{int,HF}$.

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encounter undefined symbols. If you find it is never defined or has conflicts in the conventions, you should stop and let me know):  
$a_{i \sigma}$ and $b_{i \sigma}$ represent the annihilation operators of electron with the spin $\sigma(=\uparrow, \downarrow)$ at the Ni and Bi sites of $i$-th unit cell, respectively; 
$n^{\rm N}_{i \sigma} = a^{\dagger}_{i \sigma} a_{i \sigma}$ and $n^{\rm B}_{i \sigma} = b^{\dagger}_{i \sigma} b_{i \sigma}$.


===  
EXAMPLE 1:  
For a four-fermion term $a_1^\dagger a_2^\dagger a_3 a_4$, using Wick's theorem and preserving only the normal terms. this is expanded as $a_1^\dagger a_2^\dagger a_3 a_4 = \langle a_1^\dagger a_4 \rangle a_2^\dagger a_3 + \langle a_2^\dagger a_3 \rangle a_1^\dagger a_4 - \langle a_1^\dagger a_4 \rangle \langle a_2^\dagger a_3\rangle - \langle a_1^\dagger a_3 \rangle a_2^\dagger a_4 - \langle a_2^\dagger a_4 \rangle a_1^\dagger a_3 + \langle a_1^\dagger a_3\rangle \langle a_2^\dagger a_4 \rangle$  
Be cautious about the order of the index and sign before each term here.

EXAMPLE 2:  
For a four-fermion term $a_1^\dagger a_2 a_3^\dagger a_4$, using Wick's theorem and preserving only the normal terms. this is expanded as $a_1^\dagger a_2 a_3^\dagger a_4 = \langle a_1^\dagger a_2 \rangle a_3^\dagger a_4 + \langle a_3^\dagger a_4 \rangle a_1^\dagger a_2 - \langle a_1^\dagger a_2 \rangle \langle a_3^\dagger a_4\rangle - \langle a_1^\dagger a_4 \rangle a_3^\dagger a_2 - \langle a_3^\dagger a_2 \rangle a_1^\dagger a_4 + \langle a_1^\dagger a_4\rangle \langle a_3^\dagger a_2 \rangle$  
Be cautious about the order of the index and sign before each term here.

**Completion:**  
The interaction term $H_{int}$ can be expanded using Wick's theorem as follows:

For the Bi-Bi interaction term, we have:

$\frac{U_{\rm B}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

Using Wick's theorem and preserving only the normal terms, this is expanded as:

$\frac{U_{\rm B}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  (\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle b_{k_2, \sigma} b^{\dagger}_{k_3, \sigma'} + \langle b_{k_2, \sigma} b^{\dagger}_{k_3, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} - \langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle \langle b_{k_2, \sigma} b^{\dagger}_{k_3, \sigma'} \rangle) \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

Similarly, for the Ni-Ni interaction term, we have:

$\frac{U_{\rm N}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

Using Wick's theorem and preserving only the normal terms, this is expanded as:

$\frac{U_{\rm N}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  (\langle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} \rangle a_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} + \langle a_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} \rangle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} - \langle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} \rangle \langle a_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} \rangle) \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

For the Bi-Ni interaction term, we have:

$\frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \sum_{n'} e^{-i(k_3-k_4)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

Using Wick's theorem and preserving only the normal terms, this is expanded as:

$\frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  (\langle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} \rangle b_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} + \langle b_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} - \langle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} \rangle \langle b_{k_2, \sigma} a^{\dagger}_{k_3, \sigma'} \rangle) \sum_{n'} e^{-i(k_3-k_4)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

The expanded interaction term after Hartree-Fock approximation is denoted as $\hat{H}^{int,HF}$, which is the sum of the above three terms.

## Extract quadratic term  
**Prompt:**  
You will be instructed to extract the quadratic terms in the $\hat{H}^{int,HF}$.  
The quadratic terms mean terms that are proportional to $a^\dagger a$, $b^\dagger b$ and $a^\dagger b$, which excludes terms that are solely expectations or products of expectations.  
You should only preserve the quadratic terms in $\hat{H}^{int,HF}$, denoted as $\hat{H}^{int,HF,2}$.  
You should recall that $\hat{H}^{int,HF}$ is $\frac{U_{\rm B}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} + 
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} -
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle  \langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle-
\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} -
\langle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'}  +
\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle \langle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} \rangle
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{U_{\rm N}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  \left( 
\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} + 
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} -
\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle  \langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle-
\langle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_3, \sigma'}a_{k_2, \sigma} -
\langle a^{\dagger}_{k_3, \sigma'}a_{k_2, \sigma} \rangle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} +
\langle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} \rangle \langle a^{\dagger}_{k_3, \sigma'}a_{k_2, \sigma} \rangle
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm B} }{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} + 
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} -
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle  \langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle-
\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} -
\langle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'}+
\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle \langle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} \rangle
\right) \sum_n e^{-i(k_3-k_4)\cdot n} \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'}+
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma}  -
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma}\rangle \langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle-
\langle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'}\rangle a^{\dagger}_{k_3, \sigma'}  b_{k_2, \sigma}  -
\langle a^{\dagger}_{k_3, \sigma'}  b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'}+
\langle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'}\rangle \langle a^{\dagger}_{k_3, \sigma'}  b_{k_2, \sigma} \rangle
\right) \sum_{n'} e^{-i(k_3-k_4)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$
.  
Return $\hat{H}^{int,HF,2}$.  

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encounter undefined symbols. If you find it is never defined or has conflicts in the conventions, you should stop and let me know):  
$\hat{H}^{int,HF,2}$ : the quadratic terms in $\hat{H}^{int,HF}$

**Completion:**  
The quadratic terms in $\hat{H}^{int,HF}$, denoted as $\hat{H}^{int,HF,2}$, are given by:

$\hat{H}^{int,HF,2} = \frac{U_{\rm B}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} + 
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} -
\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} -
\langle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'}  
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{U_{\rm N}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  \left( 
\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} + 
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} -
\langle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_3, \sigma'}a_{k_2, \sigma} -
\langle a^{\dagger}_{k_3, \sigma'}a_{k_2, \sigma} \rangle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} 
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm B} }{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} + 
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} -
\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} -
\langle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} 
\right) \sum_n e^{-i(k_3-k_4)\cdot n} \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'}+
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma}  -
\langle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'}\rangle a^{\dagger}_{k_3, \sigma'}  b_{k_2, \sigma}  -
\langle a^{\dagger}_{k_3, \sigma'}  b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} 
\right) \sum_{n'} e^{-i(k_3-k_4)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

The terms that are solely expectations or products of expectations have been excluded.

## Hartree term only  
**Prompt:**  
You will be instructed to keep only the Hartree term in $\hat{H}^{int,HF,2}$.  
Here, Hartree term only means that only the expected value in the form $\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle$ and $\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle$ (Note that the two indices are the same) should be the preserved. All other expected value terms should be dropped.
You should recall that $\hat{H}^{int,HF,2}$ is $\frac{U_{\rm B}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} + 
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} -
\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} -
\langle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'}  
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{U_{\rm N}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  \left( 
\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} + 
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} -
\langle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_3, \sigma'}a_{k_2, \sigma} -
\langle a^{\dagger}_{k_3, \sigma'}a_{k_2, \sigma} \rangle a^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'} 
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm B} }{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} + 
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} -
\langle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} -
\langle b^{\dagger}_{k_3, \sigma'}b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} b_{k_4, \sigma'}
\right) \sum_n e^{-i(k_3-k_4)\cdot n} \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'}+
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma}  -
\langle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'}\rangle a^{\dagger}_{k_3, \sigma'}  b_{k_2, \sigma}  -
\langle a^{\dagger}_{k_3, \sigma'}  b_{k_2, \sigma} \rangle b^{\dagger}_{k_1, \sigma} a_{k_4, \sigma'}
\right) \sum_{n'} e^{-i(k_3-k_4)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$
  
Return the simplified Hamiltonian with $\hat{H}^{int,Hartree}$.

**Completion:**  
The Hartree term in $\hat{H}^{int,HF,2}$ only preserves the expected value in the form $\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle$ and $\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle$ where the two indices are the same. Therefore, we drop all other expected value terms. The simplified Hamiltonian with $\hat{H}^{int,Hartree}$ is:

$\hat{H}^{int,Hartree} = \frac{U_{\rm B}}{2N} \sum_{k, \sigma \neq \sigma'}  
\left(
\langle b^{\dagger}_{k, \sigma} b_{k, \sigma} \rangle b^{\dagger}_{k, \sigma'} b_{k, \sigma'} + 
\langle b^{\dagger}_{k, \sigma'} b_{k, \sigma'} \rangle b^{\dagger}_{k, \sigma} b_{k, \sigma} 
\right) + 
\frac{U_{\rm N}}{2N} \sum_{k, \sigma \neq \sigma'}  \left( 
\langle a^{\dagger}_{k, \sigma} a_{k, \sigma} \rangle a^{\dagger}_{k, \sigma'} a_{k, \sigma'} + 
\langle a^{\dagger}_{k, \sigma'} a_{k, \sigma'} \rangle a^{\dagger}_{k, \sigma} a_{k, \sigma} 
\right) + 
\frac{V_{\rm B} }{N} \sum_{k, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k, \sigma} b_{k, \sigma} \rangle b^{\dagger}_{k, \sigma'} b_{k, \sigma'} + 
\langle b^{\dagger}_{k, \sigma'} b_{k, \sigma'} \rangle b^{\dagger}_{k, \sigma} b_{k, \sigma} 
\right) + 
\frac{V_{\rm BN}}{N} \sum_{k, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k, \sigma} b_{k, \sigma} \rangle a^{\dagger}_{k, \sigma'} a_{k, \sigma'}+
\langle a^{\dagger}_{k, \sigma'} a_{k, \sigma'} \rangle b^{\dagger}_{k, \sigma} b_{k, \sigma}  
\right)$

This is the simplified Hamiltonian with only the Hartree term.

## Swap the index only  
**Prompt:**  
You will be instructed to simplify the quadratic term $\hat{H}^{int,Hartree}$ through relabeling the index.  
The logic is that the expected value ($\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle$ and $\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle$) in the first Hartree term ($\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'}$ and $\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'}$) has the same form as the quadratic operators in the second Hartree term ($\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma}$ and $\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma}$), and vice versa. The same applies to the Fock term.  
Namely, a replacement of $k_1 \leftrightarrow k_3$ and $k_2 \leftrightarrow k_4$, $\sigma \leftrightarrow \sigma'$ is applied to ONLY the second Hartree or Fock term. You should not swap any index that is not in the summation, which includes the different orbitals, namely $a^\dagger$ and $b^\dagger$.  
This means, if you relabel the index by swapping the index in the "expected value" and "quadratic operators" in the second Hartree or Fock term, you can make the second Hartree or Fock term look identical to the first Hartree or Fock term, as long as $V(q)=V(-q)$, which is naturally satisfied in Coulomb interaction. You should follow the EXAMPLE below to simplify it through relabeling the index.  
You should recall that $\hat{H}^{int,Hartree}$ is $\frac{U_{\rm B}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} + 
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} 
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{U_{\rm N}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  \left( 
\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} + 
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} 
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm B} }{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} + 
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} 
\right) \sum_n e^{-i(k_3-k_4)\cdot n} \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'}+
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma}  
\right) \sum_{n'} e^{-i(k_3-k_4)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

Return the simplified $\hat{H}^{int,Hartree}$.

===  
EXAMPLE:  
Given a Hamiltonian $\hat{H}=\sum_{k_1,k_2, k_3, k_4,\sigma_1,\sigma_2,\sigma_3,\sigma_4} V(k_1-k_4) (\langle c_{d,\sigma_1}^\dagger(k_1) c_{d,\sigma_4}(k_4) \rangle c_{p,\sigma_2}^\dagger(k_2) c_{p,\sigma_3}(k_3) + \langle c_{p,\sigma_2}^\dagger(k_2) c_{d,\sigma_3}(k_3) \rangle c_{d,\sigma_1}^\dagger(k_1) c_{\sigma_4}(k_4) ) \delta_{k_1+k_2,k_3+k_4}$, where $V(q)=V(-q)$.  
In the second term, we relabel the index to swap the index in expected value and the index in quadratic operators, namely, $\sigma_1 \leftrightarrow \sigma_2$, $\sigma_3 \leftrightarrow \sigma_4$, $k_1 \leftrightarrow k_2$, $k_3 \leftrightarrow k_4$. Important: $d$ and $p$ cannot be swapped because they are not indices in the summation.  
After the replacement, the second term becomes $\sum_{k_1,k_2, k_3, k_4,\sigma_1,\sigma_2,\sigma_3,\sigma_4} V(k_2-k_3) \langle c_{p,\sigma_1}^\dagger(k_1) c_{p,\sigma_4}(k_4) \rangle c_{d,\sigma_2}^\dagger(k_2) c_{d,\sigma_3}(k_3) \delta_{k_4+k_3,k_2+k_1}$.  
Note that the Kronecker dirac function $\delta_{k_4+k_3,k_2+k_1}$ implies $k_1+k_2=k_3+k_4$, i.e., $k_2-k_3=k_4-k_1$. Thus, the second term simplifies to $\sum_{k_1,k_2, k_3, k_4,\sigma_1,\sigma_2,\sigma_3,\sigma_4} V(k_4-k_1) \langle c_{p,\sigma_1}^\dagger(k_1) c_{p,\sigma_4}(k_4) \rangle c_{d,\sigma_2}^\dagger(k_2) c_{d,\sigma_3}(k_3) \delta_{k_4+k_3,k_2+k_1}$.
Because $V(q)=V(-q)$, meaning $V(k_4-k_1)=V(k_1-k_4)$, the second term further simplifies to $\sum_{k_1,k_2, k_3, k_4,\sigma_1,\sigma_2,\sigma_3,\sigma_4} V(k_1-k_4) \langle c_{p,\sigma_1}^\dagger(k_1) c_{p,\sigma_4}(k_4) \rangle c_{d,\sigma_2}^\dagger(k_2) c_{d,\sigma_3}(k_3) \delta_{k_4+k_3,k_2+k_1}$.   
Finally, we have the simplified Hamiltonian as  $\hat{H}=\sum_{k_1,k_2, k_3, k_4,\sigma_1,\sigma_2,\sigma_3,\sigma_4} V(k_1-k_4) (\langle c_{d,\sigma_1}^\dagger(k_1) c_{d,\sigma_4}(k_4) \rangle c_{p,\sigma_2}^\dagger(k_2) c_{p,\sigma_3}(k_3) + \langle c_{p,\sigma_1}^\dagger(k_1) c_{p,\sigma_4}(k_4) \rangle c_{d,\sigma_2}^\dagger(k_2) c_{d,\sigma_3}(k_3)) \delta_{k_4+k_3,k_2+k_1}$.

**Completion:**  
Following the example, we can simplify $\hat{H}^{int,Hartree}$ by relabeling the indices in the second Hartree term. We swap $k_1 \leftrightarrow k_3$ and $k_2 \leftrightarrow k_4$, $\sigma \leftrightarrow \sigma'$ in the second Hartree term. 

After the replacement, the second Hartree term becomes:

$\frac{U_{\rm B}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

$\frac{U_{\rm N}}{2N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

$\frac{V_{\rm B} }{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  
\langle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \sum_n e^{-i(k_1-k_2)\cdot n} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

$\frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  
\langle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \rangle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \sum_{n'} e^{-i(k_1-k_2)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

Because $V(q)=V(-q)$, we can simplify the second Hartree term to look identical to the first Hartree term. 

The simplified $\hat{H}^{int,Hartree}$ is:

$\frac{U_{\rm B}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

$\frac{U_{\rm N}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

$\frac{2V_{\rm B} }{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} \sum_n e^{-i(k_1-k_2)\cdot n} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

$\frac{2V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} \sum_{n'} e^{-i(k_1-k_2)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$

## Reduce momentum in Hartree term (momentum in BZ)  
**Prompt:**  
You will be instructed to simplify the Hartree term, $\hat{H}^{int,Hartree}$, by reducing the momentum inside the expected value $\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle$ and $\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle$.  
The expected value $\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle$ and $\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle$ is only nonzero when the two momenta $k_i,k_j$ are the same, namely, $\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle = \langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle \delta_{k_1,k_2} $ and $\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle = \langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle \delta_{k_1,k_2}$.  
You should use the property of Kronecker delta function $\delta_{k_i,k_j}$ to reduce one momentum $k_i$.
Once you reduce one momentum inside the expected value $\langle\dots\rangle$. You will also notice the total momentum conservation will reduce another momentum in the quadratic term. Therefore, you should end up with only two momenta left in the summation.  
You should follow the EXAMPLE below to reduce one momentum in the Hartree term, and another momentum in the quadratic term.  
You should recall that $\hat{H}^{int,Hartree}$ is $\frac{U_{\rm B}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  
\left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'} 
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{U_{\rm N}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma \neq \sigma'}  \left( 
\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'} 
\right) \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{2V_{\rm B} }{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'}  
\right) \sum_n e^{i(k_1-k_2)\cdot n} \sum_G\delta_{k_1+k_3-k_2-k_4,G} + 
\frac{V_{\rm BN}}{N} \sum_{k_1,k_2,k_3,k_4, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_4, \sigma'}+
\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_4, \sigma'}
\right) \sum_{n'} e^{i(k_1-k_2)\cdot n'} \sum_G\delta_{k_1+k_3-k_2-k_4,G}$
.  
Return the final simplified Hartree term $\hat{H}^{int,Hartree}$.

===  
EXAMPLE:  
Given a Hamiltonian where the Hartree term $\hat{H}^{Hartree}=\sum_{k_1,k_2, k_3, k_4,s_1,s_2} V(k_1-k_4) \langle c_{s_1}^\dagger(k_1) c_{s_1}(k_4) \rangle c_{s_2}^\dagger(k_2) c_{s_2}(k_3) \sum_{G}\delta_{k_1+k_2-k_3-k_4,G}$, where $k_i$ is the momentum inside first Brilloun zone, $G$ is the reciprocal lattice vectors, and $s_i$ is a certain index for the degree of freedom other than momentum.   
Inside the expected value, we realize $\langle c_{s_1}^\dagger(k_1) c_{s_1}(k_4) \rangle$ is nonzero only when $k_1=k_4$, i.e., $\langle c_{s_1}^\dagger(k_1) c_{s_1}(k_4) \rangle=\langle c_{s_1}^\dagger(k_1) c_{s_1}(k_4) \rangle\delta_{k_1,k_4}$.  
Thus, the Hartree term becomes $\sum_{k_1,k_2, k_3, k_4,s_1,s_2} V(k_1-k_4) \langle c_{s_1}^\dagger(k_1) c_{s_1}(k_4) \rangle \delta_{k_1,k_4} c_{s_2}^\dagger(k_2) c_{s_2}(k_3) \sum_{G}\delta_{k_1+k_2-k_3-k_4,G}$.  
Use the property of Kronecker delta function $\delta_{k_1,k_4}$ to sum over $k_4$, we have $\sum_{k_1, k_2, k_3,s_1,s_2} V(k_1-k_1) \langle c_{s_1}^\dagger(k_1) c_{s_1}(k_1) \rangle c_{s_2}^\dagger(k_2) c_{s_2}(k_3) \sum_{G}\delta_{k_1+k_2-k_3-k_1,G}=\sum_{k_1, k_2, k_3,s_1,s_2} V(0) \langle c_{s_1}^\dagger(k_1) c_{s_1}(k_1) \rangle c_{s_2}^\dagger(k_2) c_{s_2}(k_3) \sum_{G}\delta_{k_2-k_3,G}$.  
We can further simplify $\sum_{G}\delta_{k_2-k_3,G}$. Because $k_i$ is momentum inside first Brilloun zone, and the difference between $k_2$ and $k_3$ cannot exceed the first shell of reciprocal lattice vector, which means $G$ can only take the value of the origin point in the reciprocal lattice, therefore, $\sum_{G}\delta_{k_2-k_3,G}=\delta_{k_2-k_3,0}$.   
Thus, the Hartree term simplifies to $\sum_{k_1, k_2, k_3,s_1,s_2} V(0) \langle c_{s_1}^\dagger(k_1) c_{s_1}(k_1) \rangle c_{s_2}^\dagger(k_2) c_{s_2}(k_3) \delta_{k_2-k_3,0}=\sum_{k_1, k_2,s_1,s_2} V(0) \langle c_{s_1}^\dagger(k_1) c_{s_1}(k_1) \rangle c_{s_2}^\dagger(k_2) c_{s_2}(k_2)$.  
Therefore, the final simplified Hartree term after reducing one momentum is $\hat{H}^{Hartree}=\sum_{k_1, k_2,s_1,s_2} V(0) \langle c_{s_1}^\dagger(k_1) c_{s_1}(k_1) \rangle c_{s_2}^\dagger(k_2) c_{s_2}(k_2)$

**Completion:**  
Following the example, we can simplify the Hartree term $\hat{H}^{int,Hartree}$ by reducing the momentum inside the expected value $\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle$ and $\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle$ using the property of the Kronecker delta function $\delta_{k_i,k_j}$.

First, we apply the Kronecker delta function to the expected values:

$\langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle = \langle b^{\dagger}_{k_1, \sigma} b_{k_2, \sigma} \rangle \delta_{k_1,k_2}$

$\langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle = \langle a^{\dagger}_{k_1, \sigma} a_{k_2, \sigma} \rangle \delta_{k_1,k_2}$

Then, we sum over $k_2$ and $k_4$ respectively, which reduces the momentum inside the expected values:

$\langle b^{\dagger}_{k_1, \sigma} b_{k_1, \sigma} \rangle$

$\langle a^{\dagger}_{k_1, \sigma} a_{k_1, \sigma} \rangle$

Next, we apply the total momentum conservation $\delta_{k_1+k_3-k_2-k_4,G}$, which reduces another momentum in the quadratic term. Since $k_1=k_2$ and $k_3=k_4$, we have $\delta_{k_1+k_3-k_1-k_3,G}=\delta_{G,0}$.

Finally, we end up with only two momenta left in the summation. The simplified Hartree term $\hat{H}^{int,Hartree}$ is:

$\hat{H}^{int,Hartree} = \frac{U_{\rm B}}{N} \sum_{k_1,k_3, \sigma \neq \sigma'}  
\left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_1, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_3, \sigma'} 
\right) + 
\frac{U_{\rm N}}{N} \sum_{k_1,k_3, \sigma \neq \sigma'}  \left( 
\langle a^{\dagger}_{k_1, \sigma} a_{k_1, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_3, \sigma'} 
\right) + 
\frac{2V_{\rm B} }{N} \sum_{k_1,k_3, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_1, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_3, \sigma'}  
\right) + 
\frac{V_{\rm BN}}{N} \sum_{k_1,k_3, \sigma, \sigma'}  \left(
\langle b^{\dagger}_{k_1, \sigma} b_{k_1, \sigma} \rangle a^{\dagger}_{k_3, \sigma'} a_{k_3, \sigma'}+
\langle a^{\dagger}_{k_1, \sigma} a_{k_1, \sigma} \rangle b^{\dagger}_{k_3, \sigma'} b_{k_3, \sigma'}
\right)$

